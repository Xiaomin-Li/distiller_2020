# time python3 compress_classifier.py --arch vgg16_cifar  ../../../data.cifar10 -p=50 --lr=0.01 --epochs=180 --compress=../agp-pruning/myyaml/vgg16/vgg16_fg_4hy_30spa.yaml --resume-from=./logs/[vgg16_cifar path] --reset-optimizer --vs=0 -n vgg16_cifar_fg_4hy_30spa

pruners:

  fine_pruner:
    class: AutomatedGradualPruner
    initial_sparsity : 0.05
    final_sparsity: 0.50
    weights: [
              features.module.2.weight,
              #features.module.5.weight,
              features.module.7.weight, 
              #features.module.10.weight,
              features.module.12.weight,
              #features.module.14.weight,
              features.module.17.weight,
              #features.module.19.weight,
              features.module.21.weight,
              #features.module.24.weight,
              features.module.26.weight,
              #features.module.28.weight
              ]

lr_schedulers:
  pruning_lr:
    class: StepLR
    step_size: 50
    gamma: 0.10


policies:
  - pruner:
      instance_name : fine_pruner
    starting_epoch: 0
    ending_epoch: 30
    frequency: 2

  - lr_scheduler:
      instance_name: pruning_lr
    starting_epoch: 0
    ending_epoch: 400
    frequency: 1
